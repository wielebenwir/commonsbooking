!function(l){"use strict";l(function(){let o=l("#full-day"),t=l("#repetition-start_time"),i=l("#repetition-end_time"),n=!1,a=l("#item-id"),c=l("#location-id"),r=l("#repetition-start_date"),s=l("#_cb_bookingcode");if(![o,t,i,a,c,r,s].every(e=>1===e.length))return;o.on("change",function(e){o.is(":checked")?(t.val("00:00"),i.val("23:59"),t.hide(),i.hide()):(t.show(),i.show())}),o.trigger("change"),a.on("change",function(e){var t={itemID:a.val()};l.post(cb_ajax_get_bookable_location.ajax_url,{_ajax_nonce:cb_ajax_get_bookable_location.nonce,action:"cb_get_bookable_location",data:t},function(e){e.success&&(c.val(e.locationID),o.prop("checked",e.fullDay),o.trigger("change"))}).then(()=>{d()})}),a.trigger("change");const d=()=>{var e;o.is(":checked")&&(e={itemID:a.val(),locationID:c.val(),startDate:r.val()},l.post(cb_ajax_get_booking_code.ajax_url,{_ajax_nonce:cb_ajax_get_booking_code.nonce,action:"cb_get_booking_code",data:e},function(e){e.success?(s.val(e.bookingCode),n=!1):n||s.val("")}))};s.on("keyup",function(e){n=!0}),r.on("change",function(e){d()}),o.on("change",function(e){d()})})}(jQuery),function(j){"use strict";j(function(){function v(){var t=j("#"+k+"_repeat");t.on("cmb2_add_row cmb2_remove_row cmb2_shift_rows_complete",function(){v()});for(let e=0;e<t.children().length-1;e++){var o=j("#"+x+e);let n=o.find("#"+k+"_"+e+"_rule-type"),a=o.find('[class*="rule-description"]').find(".cmb2-metabox-description"),c=o.find('[class*="'+w+'"]'),r=o.find('[class*="'+y+'"]'),s=o.find('[class*="exempt-roles"]'),d=o.find('[class*="rule-param1"]');var i=d.find(".cmb2-text-small");let l=j(i.labels()[0]),p=d.find(".cmb2-metabox-description"),m=o.find('[class*="rule-param2"]');i=m.find(".cmb2-text-small");let u=j(i.labels()[0]),h=m.find(".cmb2-metabox-description"),_=o.find('[class*="rule-select-param"]'),f=_.find(".cmb2-metabox-description"),g=_.find(".cmb2_select");n.change(function(){v()});const b=j("option:selected",n).val();if(""===b)return a.hide(),d.hide(),m.hide(),_.hide(),c.hide(),r.hide(),s.hide();cb_booking_rules.forEach(t=>{if(t.name==b){if(a.text(t.description),n.width(300),c.show(),r.show(),s.show(),a.show(),t.hasOwnProperty("params")&&0<t.params.length)switch(t.params.length){case 1:d.show(),m.hide(),l.text(t.params[0].title),p.text(t.params[0].description),m.val("");break;case 2:d.show(),m.show(),l.text(t.params[0].title),p.text(t.params[0].description),u.text(t.params[1].title),h.text(t.params[1].description)}else d.hide(),d.val(""),m.hide(),m.val("");if(t.hasOwnProperty("selectParam")&&0<t.selectParam.length){_.show(),f.text(t.selectParam[0]);var e,o=t.selectParam[1];for(e in g.empty(),o)g.append(j("<option>",{value:e,text:o[e]}));g.width(150);var i=cb_applied_booking_rules.filter(e=>e.name==t.name);1===i.length&&g.val(i[0].appliedSelectParam)}else _.hide()}})}}function n(){var t=j("#"+k+"_repeat");t.on("cmb2_add_row cmb2_remove_row cmb2_shift_rows_complete",function(){n()});for(let e=0;e<t.children().length-1;e++){var o=j("#"+x+e),i=o.find('[class*="'+w+'"]').find(".cmb2-option"),o=o.find('[class*="'+y+'"]');i.change(function(){n()}),i.prop("checked")?o.hide():o.show()}}const k="rules_group",x="cmb-group-rules_group-",w="rule-applies-all",y="rule-applies-categories";n(),v()})}(jQuery);const CB_POST_TYPES_WITH_METABOXES=["cb_location","cb_item","cb_timeframe","cb_booking","cb_restriction","cb_map"];function init(){const t=wp.data.subscribe(()=>{var e=wp.data.select("core/editor");e&&"function"==typeof e.getCurrentPostType&&(e=e.getCurrentPostType())&&(t(),CB_POST_TYPES_WITH_METABOXES.includes(e))&&(e=wp.data.select("core/preferences"))&&"function"==typeof e.get&&void 0===e.get("core/edit-post","metaBoxesMainIsOpen")&&wp.data.dispatch("core/preferences").set("core/edit-post","metaBoxesMainIsOpen",!0)})}!function e(){window.wp&&wp.data&&wp.data.select&&wp.data.subscribe?init():setTimeout(e,50)}(),function(h){"use strict";h(function(){let t=h("#export-type"),o=h("#location-fields"),i=h("#item-fields"),a=h("#user-fields"),c=h("#export-timerange-start"),r=h("#export-timerange-end"),s=h("#timeframe-export-in-progress"),d=h("#timeframe-export-in-progress span"),l=h("#timeframe-export-done"),p=h("#timeframe-export-failed"),m=h("#timeframe-export-failed span"),u=h("#timeframe-export-done span");h("#timeframe-export-start").on("click",function(e){e.preventDefault();e={settings:{exportType:t.val(),locationFields:o.val(),itemFields:i.val(),userFields:a.val(),exportStartDate:c.val(),exportEndDate:r.val()},progress:"0/0 bookings exported"};u.hide(),m.hide(),s.show();const n=e=>{h.post(cb_ajax_export_timeframes.ajax_url,{_ajax_nonce:cb_ajax_export_timeframes.nonce,action:"cb_export_timeframes",data:e},function(e){var t,o,i;e.success?(l.show(),u.text(e.message),s.hide(),t=new Blob([e.csv]),o=e.filename,(i=document.createElement("a")).href=URL.createObjectURL(t),i.download=o,i.click()):e.error?(p.show(),m.text(e.message),s.hide()):(d.text(e.progress),n(e))})};n(e)})})}(jQuery),function(a){"use strict";a(function(){var e=a("#holiday_load_btn");const i=a("#timeframe_manual_date");var t=a("#cmb2_multiselect_datepicker"),n=e=>{var t=e.getDate(),o=e.getMonth()+1,t=t<=9?"0"+t:t,o=o<=9?"0"+o:o,e=e.getFullYear()+"-"+o+"-"+t;0<i.val().length?","!==i.val().slice(-1)?i.val(i.val()+","+e):i.val(i.val()+e):i.val(e+",")};t.length&&t.datepicker({onSelect:function(e,t){var o=a(this).datepicker("getDate");n(o)}}),e.length&&e.click(function(){var e,t;e=a("#_cmb2_holidayholiday_year").val(),t=a("#_cmb2_holidayholiday_state").val(),feiertagejs.getHolidays(e,t).forEach(e=>{e=new Date(e.date);n(e)})})})}(jQuery),function(d){"use strict";d(function(){function e(e){d.each(e,function(){d(this).parents(".cmb-row").hide()})}function t(e){d.each(e,function(){d(this).parents(".cmb-row").show()})}function o(){(r.prop("checked")?t:e)(s)}function i(){c.prop("checked")?(t(r),o()):(e(r),e(s))}function n(){a.prop("checked")?(e(c),e(r),e(s)):(t(c),t(r),o())}const a=d("#_cb_use_global_settings"),c=d("#_cb_allow_lockdays_in_range"),r=d("#_cb_count_lockdays_in_range"),s=d("#_cb_count_lockdays_maximum");o(),r.change(function(){o()}),i(),c.change(function(){i()});n(),a.change(function(){n()})})}(jQuery),function(n){"use strict";n(function(){var e=n("#cmb2-metabox-cb_map-custom-fields");function t(e,t){function o(){n.each(t,function(){n(this).parents(".cmb-row").show()}),""===i.value&&n.each(t,function(){n(this).parents(".cmb-row").hide()})}const i=document.querySelector(e);o();new MutationObserver(function(e){e.forEach(function(e){"value"===e.attributeName&&o()})}).observe(i,{attributes:!0,childList:!1,subtree:!1})}n("#shortcode-field").find(".button").on("click",function(){var o,e;o=n("#shortcode-field"),e=n(o).find("code")[0].innerText,navigator.clipboard.writeText(e).then(function(){let e=n(o).find(".button"),t=e.text();e.text("âœ“"),e.disabled=!0,setTimeout(function(){e.text(t),e.disabled=!1},2e3)})}),e.length&&(t("#custom_marker_media",[n("#marker_icon_width"),n("#marker_icon_height"),n("#marker_icon_anchor_x"),n("#marker_icon_anchor_y")]),t("#custom_marker_cluster_media",[n("#marker_cluster_icon_width"),n("#marker_cluster_icon_height")]),t("#marker_item_draft_media",[n("#marker_item_draft_icon_width"),n("#marker_item_draft_icon_height"),n("#marker_item_draft_icon_anchor_x"),n("#marker_item_draft_icon_anchor_y")]))})}(jQuery),function(o){"use strict";o(function(){o("#orphans-migration-start").on("click",function(e){e.preventDefault(),o("#orphans-migration-in-progress").show();e=o(".post-checkboxes:checkbox:checked");let t=[];e.each(function(){t.push(o(this).val())});e=t;o.post(cb_ajax_orphaned_booking_migration.ajax_url,{_ajax_nonce:cb_ajax_orphaned_booking_migration.nonce,action:"cb_orphaned_booking_migration",data:e}).done(function(e){e.success?(o("#orphans-migration-in-progress").hide(),o("#orphans-migration-done").show(),o("#orphans-migration-done span").text(e.message),t.forEach(function(e){o("#row-booking-"+e).remove()})):(o("#orphans-migration-in-progress").hide(),o("#orphans-migration-failed").show(),o("#orphans-migration-failed span").text(e.message))})})})}(jQuery),function(i){"use strict";i(function(){0==i("#upgrade-fields").length&&i(".cmb2-id-upgrade-header").hide(),i("#cmb2-metabox-migration #run-upgrade").on("click",function(e){e.preventDefault(),i("#upgrade-in-progress").show(),i("#run-upgrade").hide();const t=e=>{i.post(cb_ajax_run_upgrade.ajax_url,{_ajax_nonce:cb_ajax_run_upgrade.nonce,action:"cb_run_upgrade",data:e},function(e){e.success?(i("#upgrade-in-progress").hide(),i("#upgrade-done").show()):t(e)})};t({progress:{task:0,page:1}})}),i("#cmb2-metabox-migration #migration-start").on("click",function(e){e.preventDefault(),i("#migration-state").show(),i("#migration-in-progress").show();const t=e=>{i.post(cb_ajax_start_migration.ajax_url,{_ajax_nonce:cb_ajax_start_migration.nonce,action:"cb_start_migration",data:e,geodata:i("#get-geo-locations").is(":checked")},function(e){let o=!0;i.each(e,function(e,t){i("#"+e+"-index").text(t.index),i("#"+e+"-count").text(t.count),"0"==t.complete&&(o=!1)}),o?(i("#migration-in-progress").hide(),i("#migration-done").show()):t(e)})};t(!1)}),i("#cmb2-metabox-migration #booking-update-start").on("click",function(e){e.preventDefault(),i("#booking-migration-in-progress").show(),i.post(cb_ajax_start_migration.ajax_url,{_ajax_nonce:cb_ajax_start_migration.nonce,action:"cb_start_booking_migration"}).done(function(){i("#booking-migration-in-progress").hide(),i("#booking-migration-done").show()}).fail(function(){i("#booking-migration-in-progress").hide(),i("#booking-migration-failed").show()})})})}(jQuery),function(t){"use strict";t(function(){const e=t("input[name=post_type][value=cb_restriction]").parent("form").find("#cb_restriction-custom-fields");e.find("input, select, textarea").on("keyup change paste",function(){e.find("input[name=restriction-send]").prop("disabled",!0)})})}(jQuery),function(i){"use strict";i(function(){if(i("#templates").length){const t=i("#emailtemplates_mail-booking_ics_attach");const o=[i("#emailtemplates_mail-booking_ics_event-title"),i("#emailtemplates_mail-booking_ics_event-description")],e=function(){var e;e=o,i.each(e,function(){i(this).parents(".cmb-row").show()}),t.prop("checked")||(e=o,i.each(e,function(){i(this).parents(".cmb-row").hide()}),t.prop("checked",!1))};e(),t.click(function(){e()})}})}(jQuery),function(Z){"use strict";Z(function(){const F=function(t,e){var o=[];return jQuery.grep(e,function(e){-1==jQuery.inArray(e,t)&&o.push(e)}),o},n=function(e){Z.each(e,function(){Z(this).parents(".cmb-row").hide()})},a=function(e){Z.each(e,function(){Z(this).parents(".cmb-row").show()})};var e=Z("#cmb2-metabox-cb_timeframe-custom-fields");const o=Z("#timeframe-repetition"),i=Z("#location-select"),c=Z("#item-select");if(e.length){const o=Z("#timeframe-repetition"),s=Z("#type"),d=Z("#grid"),l=Z("#weekdays1");var e=Z("#start-time"),t=Z("#end-time"),r=Z("#title-timeframe-rep-config");const p=Z("#repetition-start"),m=Z("#repetition-end"),u=Z("#full-day"),h=Z("#title-timeframe-booking-codes"),_=Z("#show-booking-codes"),f=Z("#create-booking-codes");var A=Z("#booking-codes-download"),H=Z("#booking-codes-list"),L=Z("#email-booking-codes-list"),Y=Z("#cron-email-booking-code");const g=Z("#timeframe-bookingcodes-sendall"),q=Z("#email-booking-codes-list-all"),N=Z("#email-booking-codes-list-current"),z=Z("#email-booking-codes-list-next"),b=Z(".cmb2-id-location-id"),v=Z(".cmb2-id-location-id-list"),k=Z(".cmb2-id-item-id"),x=Z(".cmb2-id-item-id-list"),w=Z(".cmb2-id-location-category-ids"),y=Z(".cmb2-id-item-category-ids"),j=Z(".cmb2-id--cmb2-holiday");Z("#timeframe_manual_date");const D=Z("#cmb2_multiselect_datepicker"),T=Z(".cmb2-id-timeframe-manual-date");var R=Z("#timeframe-max-days"),U=Z("#timeframe-advance-booking-days"),W=Z("#booking-startday-offset"),X=Z("#title-bookings-config"),$=Z("#allowed_user_roles");const Q=[r,u,e,t,l,p,m,d],P=[u,e,t,d,p,m],G=[d,e,t],E=[f,H,A,_,L,Y],O=[_,H,A,L,Y];r=Z("input[name=post_type][value=cb_timeframe]").parent("form");const S=[R,U,W,$,X],C=()=>{var e,t;"3"==s.val()&&((t=k.find("option:selected")).prop("value")&&((e=x.find(`input[value=${t.prop("value")}]`))&&e.prop("checked",!0),t.prop("selected",!1)),(e=b.find("option:selected")).prop("value"))&&((t=v.find(`input[value=${e.prop("value")}]`))&&t.prop("checked",!0),e.prop("selected",!1))},J=(C(),function(){var e=Z("option:selected",s).val(),t=Z("option:selected",o).val();"2"===e?(a(S),a(h),j.hide()):(n(S),n(h),"3"==e&&"manual"==t?j.show():j.hide()),"3"==e?(c.show(),i.show(),C()):(c.hide(),i.hide())}),I=(J(),s.change(function(){J(),B(),I()}),function(){var e;"3"==Z("option:selected",s).val()?(b.hide(),0==(e=Z("option:selected",i).val())?(v.show(),w.hide()):1==e?(w.show(),v.hide()):2==e&&(v.hide(),w.hide())):(b.show(),v.hide(),w.hide())}),B=(I(),i.change(function(){I()}),function(){var e;"3"==Z("option:selected",s).val()?(k.hide(),0==(e=Z("option:selected",c).val())?(x.show(),y.hide()):1==e?(y.show(),x.hide()):2==e&&(x.hide(),y.hide())):(k.show(),x.hide(),y.hide())}),M=(B(),c.change(function(){B()}),function(){Z("option:selected",o).val();(u.prop("checked")?(d.prop("selected",!1),n):a)(G)}),K=(M(),u.change(function(){M()}),function(){var e=Z("option:selected",o).val(),t=Z("option:selected",s).val();e?("norep"==e?(a(P),n(F(P,Q))):(a(Q),n(F(Q,P))),"manual"===e?(T.show(),D.show(),n(p),n(m),"3"==t?j.show():j.hide()):(T.hide(),D.hide(),a(p),a(m)),"w"===e?l.parents(".cmb-row").show():(l.parents(".cmb-row").hide(),t=Z("input[name*=weekdays]"),Z.each(t,function(){Z(this).prop("checked",!1)})),M()):(n(P),n(Q))}),V=(K(),o.change(function(){K()}),function(){var e=u.prop("checked"),t=s.val(),o=p.val(),i=m.val();n(E),o&&e&&"2"===t&&(a(E),f.prop("checked")?a(O):(n(O),_.prop("checked",!1)),i?g.show():g.hide())});V(),r.find("input, select, textarea").on("keyup change paste",function(){q.addClass("disabled"),N.addClass("disabled"),z.addClass("disabled")});e=[p,m,u,s,f];Z.each(e,function(e,t){t.change(function(){V()})})}})}(jQuery),function(e){"use strict";e(function(){e(document).tooltip()})}(jQuery);