!function(v){"use strict";v(function(){function T(){var t=v("#"+b+"_repeat");t.on("cmb2_add_row cmb2_remove_row cmb2_shift_rows_complete",function(){T()});for(let e=0;e<t.children().length-1;e++){var n=v("#"+A+e);let o=n.find("#"+b+"_"+e+"_rule-type"),a=n.find('[class*="rule-description"]').find(".cmb2-metabox-description"),r=n.find('[class*="'+w+'"]'),s=n.find('[class*="'+R+'"]'),c=n.find('[class*="exempt-roles"]'),l=n.find('[class*="rule-param1"]');var i=l.find(".cmb2-text-small");let d=v(i.labels()[0]),u=l.find(".cmb2-metabox-description"),f=n.find('[class*="rule-param2"]');i=f.find(".cmb2-text-small");let m=v(i.labels()[0]),p=f.find(".cmb2-metabox-description"),h=n.find('[class*="rule-select-param"]'),g=h.find(".cmb2-metabox-description"),E=h.find(".cmb2_select");o.change(function(){T()});const _=v("option:selected",o).val();if(""===_)return a.hide(),l.hide(),f.hide(),h.hide(),r.hide(),s.hide(),c.hide();cb_booking_rules.forEach(t=>{if(t.name==_){if(a.text(t.description),o.width(300),r.show(),s.show(),c.show(),a.show(),t.hasOwnProperty("params")&&0<t.params.length)switch(t.params.length){case 1:l.show(),f.hide(),d.text(t.params[0].title),u.text(t.params[0].description),f.val("");break;case 2:l.show(),f.show(),d.text(t.params[0].title),u.text(t.params[0].description),m.text(t.params[1].title),p.text(t.params[1].description)}else l.hide(),l.val(""),f.hide(),f.val("");if(t.hasOwnProperty("selectParam")&&0<t.selectParam.length){h.show(),g.text(t.selectParam[0]);var e,n=t.selectParam[1];for(e in E.empty(),n)E.append(v("<option>",{value:e,text:n[e]}));E.width(150);var i=cb_applied_booking_rules.filter(e=>e.name==t.name);1===i.length&&E.val(i[0].appliedSelectParam)}else h.hide()}})}}function o(){var t=v("#"+b+"_repeat");t.on("cmb2_add_row cmb2_remove_row cmb2_shift_rows_complete",function(){o()});for(let e=0;e<t.children().length-1;e++){var n=v("#"+A+e),i=n.find('[class*="'+w+'"]').find(".cmb2-option"),n=n.find('[class*="'+R+'"]');i.change(function(){o()}),i.prop("checked")?n.hide():n.show()}}const b="rules_group",A="cmb-group-rules_group-",w="rule-applies-all",R="rule-applies-categories";o(),T()})}(jQuery),function(p){"use strict";p(function(){let t=p("#export-type"),n=p("#location-fields"),i=p("#item-fields"),a=p("#user-fields"),r=p("#export-timerange-start"),s=p("#export-timerange-end"),c=p("#timeframe-export-in-progress"),l=p("#timeframe-export-in-progress span"),d=p("#timeframe-export-done"),u=p("#timeframe-export-failed"),f=p("#timeframe-export-failed span"),m=p("#timeframe-export-done span");p("#timeframe-export-start").on("click",function(e){e.preventDefault();e={settings:{exportType:t.val(),locationFields:n.val(),itemFields:i.val(),userFields:a.val(),exportStartDate:r.val(),exportEndDate:s.val()},progress:"0/0 bookings exported"};c.show();const o=e=>{p.post(cb_ajax_export_timeframes.ajax_url,{_ajax_nonce:cb_ajax_export_timeframes.nonce,action:"cb_export_timeframes",data:e},function(e){var t,n,i;e.success?(d.show(),m.text(e.message),c.hide(),t=new Blob([e.csv]),n=e.filename,(i=document.createElement("a")).href=URL.createObjectURL(t),i.download=n,i.click()):e.error?(u.show(),f.text(e.message),c.hide()):(l.text(e.progress),o(e))})};o(e)})})}(jQuery),function(a){"use strict";a(function(){var e=a("#holiday_load_btn");const i=a("#timeframe_manual_date");var t=a("#cmb2_multiselect_datepicker"),o=e=>{var t=e.getDate(),n=e.getMonth()+1,t=t<=9?"0"+t:t,n=n<=9?"0"+n:n,e=e.getFullYear()+"-"+n+"-"+t;0<i.val().length?","!==i.val().slice(-1)?i.val(i.val()+","+e):i.val(i.val()+e):i.val(e+",")};t.length&&t.datepicker({onSelect:function(e,t){var n=a(this).datepicker("getDate");o(n)}}),e.length&&e.click(function(){var e,t;e=a("#_cmb2_holidayholiday_year").val(),t=a("#_cmb2_holidayholiday_state").val(),feiertagejs.getHolidays(e,t).forEach(e=>{e=new Date(e.date);o(e)})})})}(jQuery),function(l){"use strict";l(function(){function e(e){l.each(e,function(){l(this).parents(".cmb-row").hide()})}function t(e){l.each(e,function(){l(this).parents(".cmb-row").show()})}function n(){(s.prop("checked")?t:e)(c)}function i(){r.prop("checked")?(t(s),n()):(e(s),e(c))}function o(){a.prop("checked")?(e(r),e(s),e(c)):(t(r),t(s),n())}const a=l("#_cb_use_global_settings"),r=l("#_cb_allow_lockdays_in_range"),s=l("#_cb_count_lockdays_in_range"),c=l("#_cb_count_lockdays_maximum");n(),s.change(function(){n()}),i(),r.change(function(){i()});o(),a.change(function(){o()})})}(jQuery),function(i){"use strict";i(function(){0==i("#upgrade-fields").length&&i(".cmb2-id-upgrade-header").hide(),i("#cmb2-metabox-migration #run-upgrade").on("click",function(e){e.preventDefault(),i("#upgrade-in-progress").show(),i("#run-upgrade").hide();const t=e=>{i.post(cb_ajax_run_upgrade.ajax_url,{_ajax_nonce:cb_ajax_run_upgrade.nonce,action:"cb_run_upgrade",data:e},function(e){e.success?(i("#upgrade-in-progress").hide(),i("#upgrade-done").show()):t(e)})};t({progress:{task:0,page:1}})}),i("#cmb2-metabox-migration #migration-start").on("click",function(e){e.preventDefault(),i("#migration-state").show(),i("#migration-in-progress").show();const t=e=>{i.post(cb_ajax_start_migration.ajax_url,{_ajax_nonce:cb_ajax_start_migration.nonce,action:"cb_start_migration",data:e,geodata:i("#get-geo-locations").is(":checked")},function(e){let n=!0;i.each(e,function(e,t){i("#"+e+"-index").text(t.index),i("#"+e+"-count").text(t.count),"0"==t.complete&&(n=!1)}),n?(i("#migration-in-progress").hide(),i("#migration-done").show()):t(e)})};t(!1)}),i("#cmb2-metabox-migration #booking-update-start").on("click",function(e){e.preventDefault(),i("#booking-migration-in-progress").show(),i.post(cb_ajax_start_migration.ajax_url,{_ajax_nonce:cb_ajax_start_migration.nonce,action:"cb_start_booking_migration"}).done(function(){i("#booking-migration-in-progress").hide(),i("#booking-migration-done").show()}).fail(function(){i("#booking-migration-in-progress").hide(),i("#booking-migration-failed").show()})})})}(jQuery),function(t){"use strict";t(function(){const e=t("input[name=post_type][value=cb_restriction]").parent("form").find("#cb_restriction-custom-fields");e.find("input, select, textarea").on("keyup change paste",function(){e.find("input[name=restriction-send]").prop("disabled",!0)})})}(jQuery),function(i){"use strict";i(function(){if(i("#templates").length){const t=i("#emailtemplates_mail-booking_ics_attach");const n=[i("#emailtemplates_mail-booking_ics_event-title"),i("#emailtemplates_mail-booking_ics_event-description")],e=function(){var e;e=n,i.each(e,function(){i(this).parents(".cmb-row").show()}),t.prop("checked")||(e=n,i.each(e,function(){i(this).parents(".cmb-row").hide()}),t.prop("checked",!1))};e(),t.click(function(){e()})}})}(jQuery),function(X){"use strict";X(function(){const D=function(t,e){var n=[];return jQuery.grep(e,function(e){-1==jQuery.inArray(e,t)&&n.push(e)}),n},o=function(e){X.each(e,function(){X(this).parents(".cmb-row").hide()})},a=function(e){X.each(e,function(){X(this).parents(".cmb-row").show()})};var e=X("#cmb2-metabox-cb_timeframe-custom-fields");const n=X("#timeframe-repetition"),i=X("#location-select"),r=X("#item-select");if(e.length){const n=X("#timeframe-repetition"),c=X("#type"),l=X("#grid"),d=X("#weekdays1");var e=X("#start-time"),t=X("#end-time"),s=X("#title-timeframe-rep-config");const u=X("#repetition-start"),f=X("#repetition-end"),m=X("#full-day"),p=X("#title-timeframe-booking-codes"),h=X("#show-booking-codes"),g=X("#create-booking-codes");var B=X("#booking-codes-download"),O=X("#booking-codes-list"),j=X("#email-booking-codes-list"),U=X("#cron-email-booking-code");const E=X("#timeframe-bookingcodes-sendall"),Y=X("#email-booking-codes-list-all"),$=X("#email-booking-codes-list-current"),J=X("#email-booking-codes-list-next"),_=X(".cmb2-id-location-id"),T=X(".cmb2-id-location-id-list"),b=X(".cmb2-id-item-id"),A=X(".cmb2-id-item-id-list"),w=X(".cmb2-id-location-category-ids"),R=X(".cmb2-id-item-category-ids"),v=X(".cmb2-id--cmb2-holiday");X("#timeframe_manual_date");const I=X("#cmb2_multiselect_datepicker"),S=X(".cmb2-id-timeframe-manual-date");var C=X("#timeframe-max-days"),W=X("#timeframe-advance-booking-days"),P=X("#booking-startday-offset"),K=X("#title-bookings-config"),Q=X("#allowed_user_roles");const G=[s,m,e,t,d,u,f,l],N=[m,e,t,l,u,f],q=[l,e,t],x=[g,O,B,h,j,U],H=[h,O,B,j,U];s=X("input[name=post_type][value=cb_timeframe]").parent("form");const k=[C,W,P,Q,K],y=()=>{var e,t;"3"==c.val()&&((t=b.find("option:selected")).prop("value")&&((e=A.find(`input[value=${t.prop("value")}]`))&&e.prop("checked",!0),t.prop("selected",!1)),(e=_.find("option:selected")).prop("value"))&&((t=T.find(`input[value=${e.prop("value")}]`))&&t.prop("checked",!0),e.prop("selected",!1))},V=(y(),function(){var e=X("option:selected",c).val(),t=X("option:selected",n).val();"2"===e?(a(k),a(p),v.hide()):(o(k),o(p),"3"==e&&"manual"==t?v.show():v.hide()),"3"==e?(r.show(),i.show(),y()):(r.hide(),i.hide())}),L=(V(),c.change(function(){V(),M(),L()}),function(){var e;"3"==X("option:selected",c).val()?(_.hide(),0==(e=X("option:selected",i).val())?(T.show(),w.hide()):1==e?(w.show(),T.hide()):2==e&&(T.hide(),w.hide())):(_.show(),T.hide(),w.hide())}),M=(L(),i.change(function(){L()}),function(){var e;"3"==X("option:selected",c).val()?(b.hide(),0==(e=X("option:selected",r).val())?(A.show(),R.hide()):1==e?(R.show(),A.hide()):2==e&&(A.hide(),R.hide())):(b.show(),A.hide(),R.hide())}),F=(M(),r.change(function(){M()}),function(){X("option:selected",n).val();(m.prop("checked")?(l.prop("selected",!1),o):a)(q)}),Z=(F(),m.change(function(){F()}),function(){var e=X("option:selected",n).val(),t=X("option:selected",c).val();e?("norep"==e?(a(N),o(D(N,G))):(a(G),o(D(G,N))),"manual"===e?(S.show(),I.show(),o(u),o(f),"3"==t?v.show():v.hide()):(S.hide(),I.hide(),a(u),a(f)),"w"===e?d.parents(".cmb-row").show():(d.parents(".cmb-row").hide(),t=X("input[name*=weekdays]"),X.each(t,function(){X(this).prop("checked",!1)})),F()):(o(N),o(G))}),z=(Z(),n.change(function(){Z()}),function(){var e=m.prop("checked"),t=c.val(),n=u.val(),i=f.val();o(x),n&&e&&"2"===t&&(a(x),g.prop("checked")?a(H):(o(H),h.prop("checked",!1)),i?E.show():E.hide())});z(),s.find("input, select, textarea").on("keyup change paste",function(){Y.addClass("disabled"),$.addClass("disabled"),J.addClass("disabled")});e=[u,f,m,c,g];X.each(e,function(e,t){t.change(function(){z()})})}})}(jQuery),function(e){"use strict";e(function(){e(document).tooltip()})}(jQuery),function(e,t){var n,i;"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e="undefined"!=typeof globalThis?globalThis:e||self,n=e.feiertagejs,i=e.feiertagejs={},t(i),i.noConflict=function(){return e.feiertagejs=n,i})}(this,function(e){"use strict";const a=["NEUJAHRSTAG","HEILIGEDREIKOENIGE","KARFREITAG","OSTERSONNTAG","OSTERMONTAG","TAG_DER_ARBEIT","CHRISTIHIMMELFAHRT","MARIAHIMMELFAHRT","PFINGSTSONNTAG","PFINGSTMONTAG","FRONLEICHNAM","DEUTSCHEEINHEIT","REFORMATIONSTAG","ALLERHEILIGEN","BUBETAG","ERSTERWEIHNACHTSFEIERTAG","ZWEITERWEIHNACHTSFEIERTAG","WELTKINDERTAG","WELTFRAUENTAG","AUGSBURGER_FRIEDENSFEST"],t=["BW","BY","BE","BB","HB","HE","HH","MV","NI","NW","RP","SL","SN","ST","SH","TH","BUND","AUGSBURG","ALL"];let n="de";const r={de:{NEUJAHRSTAG:"Neujahrstag",HEILIGEDREIKOENIGE:"Heilige Drei Könige",KARFREITAG:"Karfreitag",OSTERSONNTAG:"Ostersonntag",OSTERMONTAG:"Ostermontag",TAG_DER_ARBEIT:"Tag der Arbeit",CHRISTIHIMMELFAHRT:"Christi Himmelfahrt",PFINGSTSONNTAG:"Pfingstsonntag",PFINGSTMONTAG:"Pfingstmontag",FRONLEICHNAM:"Fronleichnam",MARIAHIMMELFAHRT:"Mariä Himmelfahrt",DEUTSCHEEINHEIT:"Tag der Deutschen Einheit",REFORMATIONSTAG:"Reformationstag",ALLERHEILIGEN:"Allerheiligen",BUBETAG:"Buß- und Bettag",ERSTERWEIHNACHTSFEIERTAG:"1. Weihnachtstag",ZWEITERWEIHNACHTSFEIERTAG:"2. Weihnachtstag",WELTKINDERTAG:"Weltkindertag",WELTFRAUENTAG:"Weltfrauentag",AUGSBURGER_FRIEDENSFEST:"Augsburger Friedensfest"}};function i(e,t){o(t);var n=e.getFullYear(),e=f(e);return-1!==function(e,t){e=s(e,t);return e.map(e=>f(e.date))}(n,t).indexOf(e)}function o(e){if(null==e)throw new Error("Region must not be undefined or null");if(-1===t.indexOf(e))throw new Error(`Invalid region: ${e}! Must be one of `+t.toString())}function s(e,t){var n=function(e){var t=Math.floor(e/100),n=e-19*Math.floor(e/19),i=Math.floor((t-17)/25);i=t-Math.floor(t/4)-Math.floor((t-i)/3)+19*n+15,i=(i-=30*Math.floor(i/30))-Math.floor(i/28)*(1-Math.floor(i/28)*Math.floor(29/(1+i))*Math.floor((21-n)/11)),n=e+Math.floor(e/4)+i+2-t+Math.floor(t/4);n-=7*Math.floor(n/7);t=i-n,i=3+Math.floor((40+t)/44),n=28+t-31*Math.floor(i/4);return new Date(e,i-1,n)}(e),i=l(new Date(n.getTime()),-2),o=l(new Date(n.getTime()),1),a=l(new Date(n.getTime()),39),r=l(new Date(n.getTime()),49),s=l(new Date(n.getTime()),50),c=[...[u("NEUJAHRSTAG",d(c=e,1,1)),u("TAG_DER_ARBEIT",d(c,5,1)),u("DEUTSCHEEINHEIT",d(c,10,3)),u("ERSTERWEIHNACHTSFEIERTAG",d(c,12,25)),u("ZWEITERWEIHNACHTSFEIERTAG",d(c,12,26))],u("KARFREITAG",i),u("OSTERMONTAG",o),u("CHRISTIHIMMELFAHRT",a),u("PFINGSTMONTAG",s)];return i=e,o=c,"BW"!==(a=t)&&"BY"!==a&&"AUGSBURG"!==a&&"ST"!==a&&"ALL"!==a||o.push(u("HEILIGEDREIKOENIGE",d(i,1,6))),s=n,a=r,o=c,"BB"!==(i=t)&&"ALL"!==i||o.push(u("OSTERSONNTAG",s),u("PFINGSTSONNTAG",a)),r=n,i=c,"BW"!==(o=t)&&"BY"!==o&&"AUGSBURG"!==o&&"HE"!==o&&"NW"!==o&&"RP"!==o&&"SL"!==o&&"ALL"!==o||(o=l(new Date(r.getTime()),60),i.push(u("FRONLEICHNAM",o))),s=e,a=c,"SL"!==(n=t)&&"BY"!==n&&"AUGSBURG"!==n&&"ALL"!==n||a.push(u("MARIAHIMMELFAHRT",d(s,8,15))),r=t,i=c,2017!==(o=e)&&"NI"!==r&&"BB"!==r&&"HB"!==r&&"HH"!==r&&"MV"!==r&&"SN"!==r&&"ST"!==r&&"TH"!==r&&"SH"!==r&&"ALL"!==r||i.push(u("REFORMATIONSTAG",d(o,10,31))),n=e,a=c,"BW"!==(s=t)&&"BY"!==s&&"AUGSBURG"!==s&&"NW"!==s&&"RP"!==s&&"SL"!==s&&"ALL"!==s||a.push(u("ALLERHEILIGEN",d(n,11,1))),r=e,i=c,"SN"!==(o=t)&&"ALL"!==o||(o=function(e){e=new Date(e,11,25,12,0,0);let t=e.getDay()%7;0===t&&(t=7);var n=t+32;e=new Date(e.getTime());return l(e,-n)}(r),i.push(u("BUBETAG",d(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate())))),s=t,a=c,2019<=(n=e)&&("TH"===s||"ALL"===s)&&a.push(u("WELTKINDERTAG",d(n,9,20))),r=t,i=c,(o=e)<=2018||("BE"!==r&&"ALL"!==r||i.push(u("WELTFRAUENTAG",d(o,3,8))),"MV"===r&&2023<=o&&i.push(u("WELTFRAUENTAG",d(o,3,8)))),s=e,a=c,"AUGSBURG"===t&&a.push(u("AUGSBURGER_FRIEDENSFEST",d(s,8,8))),c.sort((e,t)=>e.date.getTime()-t.date.getTime())}function l(e,t){var n=new Date(e);return n.setDate(e.getDate()+t),n}function d(e,t,n){return new Date(e,t-1,n)}function u(e,t){return{name:e,date:t,dateString:c(t),trans(e=n){return console.warn('FeiertageJs: You are using "Holiday.trans() method. This will be replaced in the next major version with translate()"'),this.translate(e)},translate(e=n){return null==e?void 0:r[e][this.name]},getNormalizedDate(){return f(this.date)},equals(e){e=c(e);return this.dateString===e}}}function c(e){e=new Date(e.getTime()-60*e.getTimezoneOffset()*1e3);return e.setUTCHours(0,0,0,0),e.toISOString().slice(0,10)}function f(e){e=new Date(e);return e.setHours(0,0,0,0),e.getTime()}e.addTranslation=function(e,t){var e=e.toLowerCase(),n=r.de;let i=!1;for(const o of a)t[o]||(i=!0,t[o]=n[o]);i&&console.warn("[feiertagejs] addTranslation: you did not add all holidays in your translation! Took German as fallback"),r[e]=t},e.getHolidayByDate=function(t,e="ALL"){return o(e),s(t.getFullYear(),e).find(e=>e.equals(t))},e.getHolidays=function(e,t){let n;return n="string"==typeof e?parseInt(e,10):e,o(t),s(n,t)},e.getLanguage=function(){return n},e.isHoliday=i,e.isSpecificHoliday=function(t,e,n="ALL"){o(n);var i=e;if(null==i)throw new TypeError("holidayName must not be null or undefined");if(-1===a.indexOf(i))throw new Error(`feiertage.js: invalid holiday type "${i}"! Must be one of `+a.toString());return!!(i=s(t.getFullYear(),n).find(e=>e.equals(t)))&&i.name===e},e.isSunOrHoliday=function(e,t){return o(t),0===e.getDay()||i(e,t)},e.setLanguage=function(e){var t=e.toLowerCase();if(!r[t])throw new TypeError(`[feiertagejs] tried to set language to ${t} but the translation is missing. Please use addTranslation(isoCode,object) first`);n=e}});